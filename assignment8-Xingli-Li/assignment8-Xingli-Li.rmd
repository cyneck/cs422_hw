---
title: "CS 422 Homework 8"
author: "Xingli Li"
output:
  html_notebook: 
    toc: yes
    toc_float: yes
    toc_depth: 5
  html_document:
    toc: yes
    df_print: paged
editor_oprions:
  markdown:
    wrap: 100
---

## Homework 8

### Part 2

set work space and install dependent package.

```{r}
library(cluster)
library(factoextra)
setwd(getwd())
```

### 2.1-(a)-(i)

```{r}
#  "I", "i", "C", "c", "P", "p", "M", "m", is the tooth pattern, the 
#  number of top incisors, bottom incisors, top canines, bottom canines, 
#  top premolars, bottom premolars, top molars, and bottom molars.

df <- read.csv("file19.csv", encoding = 'UTF-8')
x <- df[,-1]
x.scaled <- scale(df[,-1])
```

Think of what attributes, if any, you may want to omit from the dataset when you do the clustering. Indicate all of the attributes you removed before doing the clustering.

Answer:

remove name of the attributes.

### 2.1-(a)-(ii)

Does the data need to be standardized? (Briefly, using 1-2 sentences, support your answer.)

Answer:

No, because they are all the teeth counts of the animals, and the unit of measurement is the same. In this case, standardization is meaningless.

### 2.1-(a)-(iii)

You will have to clean the data to remove multiple spaces and make the comma character the delimiter. Please make sure you include your cleaned dataset in the archive file you upload.

Answer:

See the file "file9.csv".

```{r}
head(df)
```

### 2.1-(b)-(i)

Determine how many clusters are needed by running the WSS or Silhouette graph. Plot the graph using fviz_nbclust().

```{r}
# How many clusters?  A couple of means to visuzalize it.
fviz_nbclust(x, kmeans, method="wss") # Elbow method minimizes total
# within-cluster sum of squares (wss).  Also called a "Scree" plot.
```

Answer:

We can know that the polyline trend changes the most when k = 3. So, there are 3 clusters.

### 2.1-(b)-(ii)

Once you have determined the number of clusters, run k-means clustering on the dataset to create that many clusters. Plot the clusters using fviz_cluster().

```{r}
km <- kmeans(x, centers=3, nstart=9) 
fviz_cluster(km, data=x)
```

### 2.1-(b)-(iii)

How many observations are in each cluster?

```{r}
print(paste("cluster 1 are",km$size[1],"observations"))
print(paste("cluster 2 are",km$size[2],"observations"))
print(paste("cluster 3 are",km$size[3],"observations"))
```

### 2.1-(b)-(iv)

What is the total SSE of the clusters?

```{r}

print(paste("The total SSE of the clusters is", round(km$totss,digits = 3)))

```

### 2.1-(b)-(v)

What is the SSE of each cluster?

每个集群的SSE是多少？

```{r}

print(paste("The SSE of the cluster 1 is", round(km$withinss[1],digits = 3)))
print(paste("The SSE of the cluster 2 is", round(km$withinss[2],digits = 3)))
print(paste("The SSE of the cluster 3 is", round(km$withinss[3],digits = 3)))
```

### 2.1-(b)-(vi)

Perform an analysis of each cluster to determine how the mammals are grouped in each cluster, and whether that makes sense? Act as the domain expert here; clustering has produced what you asked it to. Examine the results based on your knowledge of the animal kingdom and see whether the results meet expectations. Provide me a summary of your observations.

```{r}
# cluster 1:
df[which(km$cluster == 1),]
```

```{r}
# cluster 2:
df[which(km$cluster == 2),]
```

```{r}
# cluster 3:
df[which(km$cluster == 3),]
```

Answer:

it is meaningful.
